!function(e){var n={};function l(t){if(n[t])return n[t].exports;var g=n[t]={i:t,l:!1,exports:{}};return e[t].call(g.exports,g,g.exports,l),g.l=!0,g.exports}l.m=e,l.c=n,l.d=function(e,n,t){l.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},l.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,n){if(1&n&&(e=l(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(l.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var g in e)l.d(t,g,function(n){return e[n]}.bind(null,g));return t},l.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(n,"a",n),n},l.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},l.p="",l(l.s=148)}({148:function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar NAME = 'Geocoder';\nvar ERROR_COLOR = '#FFA500';\nvar CORRECTED_COLOR = '#ADFF2F';\n\nvar onInstall = function onInstall() {\n  onOpen();\n};\n\nvar onOpen = function onOpen() {\n  SpreadsheetApp.getUi().createAddonMenu().addItem(NAME, 'show').addToUi();\n};\n\nvar show = function show() {\n  var html = HtmlService.createTemplateFromFile('index').evaluate().setTitle(NAME);\n  SpreadsheetApp.getUi().showSidebar(html);\n};\n\nvar getData = function getData() {\n  return SpreadsheetApp.getActiveSheet().getDataRange().getValues();\n};\n\nvar standardCols = function standardCols(sheet, data) {\n  var length = data.cells.length;\n  var range = sheet.getRange(1, 1, 1, length);\n  var columns = range.getValues()[0];\n  var nameCol = columns.indexOf('LOCATION_NAME');\n  var lngCol = columns.indexOf('LNG');\n  var latCol = columns.indexOf('LAT');\n  nameCol = nameCol > -1 ? nameCol + 1 : length + 1;\n  lngCol = lngCol > -1 ? lngCol + 1 : length + 2;\n  latCol = latCol > -1 ? latCol + 1 : length + 3;\n  sheet.getRange(1, nameCol).setValue('LOCATION_NAME');\n  sheet.getRange(1, lngCol).setValue('LNG');\n  sheet.getRange(1, latCol).setValue('LAT');\n  return xyCols(sheet, data, {\n    name: nameCol,\n    lng: lngCol,\n    lat: latCol\n  });\n};\n\nvar xyCols = function xyCols(sheet, data, standardCols) {\n  if (data.projected) {\n    var length = data.cells.length;\n    var range = sheet.getRange(1, 1, 1, length);\n    var columns = range.getValues()[0];\n    var xCol = columns.indexOf('X');\n    var yCol = columns.indexOf('Y');\n    xCol = xCol > -1 ? xCol + 1 : length + 4;\n    yCol = yCol > -1 ? yCol + 1 : length + 5;\n    sheet.getRange(1, xCol).setValue('X');\n    sheet.getRange(1, yCol).setValue('Y');\n    standardCols.x = xCol;\n    standardCols.y = yCol;\n  }\n\n  return standardCols;\n};\n\nvar geoCols = function geoCols(sheet, data) {\n  var fields = data.requestedFields;\n  var cols = standardCols(sheet, data);\n  var dataCols = data.columns;\n  var last = cols.x || -1;\n  if (last < cols.y) last = cols.y || -1;\n  if (last < cols.lng) last = cols.lng;\n  if (last < cols.lat) last = cols.lat;\n\n  for (var i = 0; i < fields.length; i++) {\n    var field = fields[i];\n    var exists = dataCols.indexOf(field);\n\n    if (exists > -1) {\n      cols[field] = exists + 1;\n    } else {\n      last++;\n      sheet.getRange(1, last).setValue(field);\n      cols[field] = last;\n    }\n  }\n\n  return cols;\n};\n\nvar setFields = function setFields(sheet, row, cols, data) {\n  var fields = data.requestedFields;\n\n  for (var i = 0; i < fields.length; i++) {\n    var field = fields[i];\n    sheet.getRange(row, cols[field]).setValue(data.geocodeResp.data[field] || '');\n  }\n};\n\nvar geocoded = function geocoded(data) {\n  var row = data.row + 1;\n  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();\n  var cols = geoCols(sheet, data);\n\n  if (!isNaN(data.lng)) {\n    sheet.getRange(row, cols.name).setValue(data.geocodeResp.name);\n    sheet.getRange(row, cols.lng).setValue(data.lng);\n    sheet.getRange(row, cols.lat).setValue(data.lat);\n\n    if (data.projected) {\n      sheet.getRange(row, cols.x).setValue(data.x);\n      sheet.getRange(row, cols.y).setValue(data.y);\n    }\n\n    if (data.interactive) {\n      sheet.getRange(row, 1, 1, sheet.getLastColumn()).setBackground(CORRECTED_COLOR);\n    }\n\n    setFields(sheet, row, cols, data);\n  } else {\n    sheet.getRange(row, 1, 1, sheet.getLastColumn()).setBackground(ERROR_COLOR);\n  }\n\n  return {\n    columns: sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues()[0],\n    cells: sheet.getRange(row, 1, 1, sheet.getLastColumn()).getValues()[0]\n  };\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  onInstall: onInstall,\n  onOpen: onOpen,\n  getData: getData,\n  geocoded: geocoded\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTQ4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2pzL0NvZGUuanM/NjI4MiJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBOQU1FID0gJ0dlb2NvZGVyJztcbmNvbnN0IEVSUk9SX0NPTE9SID0gJyNGRkE1MDAnXG5jb25zdCBDT1JSRUNURURfQ09MT1IgPSAnI0FERkYyRidcblxuY29uc3Qgb25JbnN0YWxsID0gKCkgPT4ge1xuICBvbk9wZW4oKTtcbn1cblxuY29uc3Qgb25PcGVuID0gKCkgPT4ge1xuICBTcHJlYWRzaGVldEFwcC5nZXRVaSgpLmNyZWF0ZUFkZG9uTWVudSgpLmFkZEl0ZW0oTkFNRSwgJ3Nob3cnKS5hZGRUb1VpKClcbn1cblxuY29uc3Qgc2hvdyA9ICgpID0+IHtcbiAgY29uc3QgaHRtbCA9IEh0bWxTZXJ2aWNlLmNyZWF0ZVRlbXBsYXRlRnJvbUZpbGUoJ2luZGV4JykuZXZhbHVhdGUoKS5zZXRUaXRsZShOQU1FKVxuICBTcHJlYWRzaGVldEFwcC5nZXRVaSgpLnNob3dTaWRlYmFyKGh0bWwpXG59XG5cbmNvbnN0IGdldERhdGEgPSAoKSA9PiB7XG4gIHJldHVybiBTcHJlYWRzaGVldEFwcC5nZXRBY3RpdmVTaGVldCgpLmdldERhdGFSYW5nZSgpLmdldFZhbHVlcygpXG59XG5cbmNvbnN0IHN0YW5kYXJkQ29scyA9IChzaGVldCwgZGF0YSkgPT4ge1xuICBjb25zdCBsZW5ndGggPSBkYXRhLmNlbGxzLmxlbmd0aFxuICBjb25zdCByYW5nZSA9IHNoZWV0LmdldFJhbmdlKDEsIDEsIDEsIGxlbmd0aClcbiAgY29uc3QgY29sdW1ucyA9IHJhbmdlLmdldFZhbHVlcygpWzBdXG4gIGxldCBuYW1lQ29sID0gY29sdW1ucy5pbmRleE9mKCdMT0NBVElPTl9OQU1FJylcbiAgbGV0IGxuZ0NvbCA9IGNvbHVtbnMuaW5kZXhPZignTE5HJylcbiAgbGV0IGxhdENvbCA9IGNvbHVtbnMuaW5kZXhPZignTEFUJylcbiAgbmFtZUNvbCA9IChuYW1lQ29sID4gLTEpID8gKG5hbWVDb2wgKyAxKSA6IChsZW5ndGggKyAxKVxuICBsbmdDb2wgPSAobG5nQ29sID4gLTEpID8gKGxuZ0NvbCArIDEpIDogKGxlbmd0aCArIDIpXG4gIGxhdENvbCA9IChsYXRDb2wgPiAtMSkgPyAobGF0Q29sICsgMSkgOiAobGVuZ3RoICsgMylcbiAgc2hlZXQuZ2V0UmFuZ2UoMSwgbmFtZUNvbCkuc2V0VmFsdWUoJ0xPQ0FUSU9OX05BTUUnKVxuICBzaGVldC5nZXRSYW5nZSgxLCBsbmdDb2wpLnNldFZhbHVlKCdMTkcnKVxuICBzaGVldC5nZXRSYW5nZSgxLCBsYXRDb2wpLnNldFZhbHVlKCdMQVQnKVxuICByZXR1cm4geHlDb2xzKHNoZWV0LCBkYXRhLCB7bmFtZTogbmFtZUNvbCwgbG5nOiBsbmdDb2wsIGxhdDogbGF0Q29sfSlcbn1cblxuY29uc3QgeHlDb2xzID0gKHNoZWV0LCBkYXRhLCBzdGFuZGFyZENvbHMpID0+IHtcbiAgaWYgKGRhdGEucHJvamVjdGVkKSB7XG4gICAgY29uc3QgbGVuZ3RoID0gZGF0YS5jZWxscy5sZW5ndGhcbiAgICBjb25zdCByYW5nZSA9IHNoZWV0LmdldFJhbmdlKDEsIDEsIDEsIGxlbmd0aClcbiAgICBjb25zdCBjb2x1bW5zID0gcmFuZ2UuZ2V0VmFsdWVzKClbMF1cbiAgICBsZXQgeENvbCA9IGNvbHVtbnMuaW5kZXhPZignWCcpXG4gICAgbGV0IHlDb2wgPSBjb2x1bW5zLmluZGV4T2YoJ1knKVxuICAgIHhDb2wgPSAoeENvbCA+IC0xKSA/ICh4Q29sICsgMSkgOiAobGVuZ3RoICsgNClcbiAgICB5Q29sID0gKHlDb2wgPiAtMSkgPyAoeUNvbCArIDEpIDogKGxlbmd0aCArIDUpXG4gICAgc2hlZXQuZ2V0UmFuZ2UoMSwgeENvbCkuc2V0VmFsdWUoJ1gnKVxuICAgIHNoZWV0LmdldFJhbmdlKDEsIHlDb2wpLnNldFZhbHVlKCdZJylcbiAgICBzdGFuZGFyZENvbHMueCA9IHhDb2xcbiAgICBzdGFuZGFyZENvbHMueSA9IHlDb2xcbiAgfVxuICByZXR1cm4gc3RhbmRhcmRDb2xzXG59XG5cbmNvbnN0IGdlb0NvbHMgPSAoc2hlZXQsIGRhdGEpID0+IHtcbiAgY29uc3QgZmllbGRzID0gZGF0YS5yZXF1ZXN0ZWRGaWVsZHNcbiAgY29uc3QgY29scyA9IHN0YW5kYXJkQ29scyhzaGVldCwgZGF0YSlcbiAgY29uc3QgZGF0YUNvbHMgPSBkYXRhLmNvbHVtbnNcbiAgbGV0IGxhc3QgPSBjb2xzLnggfHwgLTFcbiAgaWYgKGxhc3QgPCBjb2xzLnkpIGxhc3QgPSBjb2xzLnkgfHwgLTFcbiAgaWYgKGxhc3QgPCBjb2xzLmxuZykgbGFzdCA9IGNvbHMubG5nXG4gIGlmIChsYXN0IDwgY29scy5sYXQpIGxhc3QgPSBjb2xzLmxhdFxuICBmb3IgKGxldCBpID0gMDsgaSA8IGZpZWxkcy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IGZpZWxkID0gZmllbGRzW2ldXG4gICAgY29uc3QgZXhpc3RzID0gZGF0YUNvbHMuaW5kZXhPZihmaWVsZClcbiAgICBpZiAoZXhpc3RzID4gLTEpIHtcbiAgICAgIGNvbHNbZmllbGRdID0gZXhpc3RzICsgMVxuICAgIH0gZWxzZSB7XG4gICAgICBsYXN0KytcbiAgICAgIHNoZWV0LmdldFJhbmdlKDEsIGxhc3QpLnNldFZhbHVlKGZpZWxkKVxuICAgICAgY29sc1tmaWVsZF0gPSBsYXN0XG4gICAgfVxuICB9XG4gIHJldHVybiBjb2xzXG59XG5cbmNvbnN0IHNldEZpZWxkcyA9IChzaGVldCwgcm93LCBjb2xzLCBkYXRhKSA9PiB7ICBcbiAgY29uc3QgZmllbGRzID0gZGF0YS5yZXF1ZXN0ZWRGaWVsZHNcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBmaWVsZHMubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBmaWVsZCA9IGZpZWxkc1tpXVxuICAgIHNoZWV0LmdldFJhbmdlKHJvdywgY29sc1tmaWVsZF0pLnNldFZhbHVlKGRhdGEuZ2VvY29kZVJlc3AuZGF0YVtmaWVsZF0gfHwgJycpXG4gIH1cbn1cblxuY29uc3QgZ2VvY29kZWQgPSAoZGF0YSkgPT4ge1xuICBjb25zdCByb3cgPSBkYXRhLnJvdyArIDFcbiAgY29uc3Qgc2hlZXQgPSBTcHJlYWRzaGVldEFwcC5nZXRBY3RpdmVTcHJlYWRzaGVldCgpLmdldEFjdGl2ZVNoZWV0KClcbiAgY29uc3QgY29scyA9IGdlb0NvbHMoc2hlZXQsIGRhdGEpXG4gIGlmICghaXNOYU4oZGF0YS5sbmcpKSB7XG4gICAgc2hlZXQuZ2V0UmFuZ2Uocm93LCBjb2xzLm5hbWUpLnNldFZhbHVlKGRhdGEuZ2VvY29kZVJlc3AubmFtZSlcbiAgICBzaGVldC5nZXRSYW5nZShyb3csIGNvbHMubG5nKS5zZXRWYWx1ZShkYXRhLmxuZylcbiAgICBzaGVldC5nZXRSYW5nZShyb3csIGNvbHMubGF0KS5zZXRWYWx1ZShkYXRhLmxhdClcbiAgICBpZiAoZGF0YS5wcm9qZWN0ZWQpIHtcbiAgICAgIHNoZWV0LmdldFJhbmdlKHJvdywgY29scy54KS5zZXRWYWx1ZShkYXRhLngpXG4gICAgICBzaGVldC5nZXRSYW5nZShyb3csIGNvbHMueSkuc2V0VmFsdWUoZGF0YS55KVxuICAgIH1cbiAgICBpZiAoZGF0YS5pbnRlcmFjdGl2ZSkge1xuICAgICAgc2hlZXQuZ2V0UmFuZ2Uocm93LCAxLCAxLCBzaGVldC5nZXRMYXN0Q29sdW1uKCkpLnNldEJhY2tncm91bmQoQ09SUkVDVEVEX0NPTE9SKVxuICAgIH1cbiAgICBzZXRGaWVsZHMoc2hlZXQsIHJvdywgY29scywgZGF0YSlcbiAgfSBlbHNlIHtcbiAgICBzaGVldC5nZXRSYW5nZShyb3csIDEsIDEsIHNoZWV0LmdldExhc3RDb2x1bW4oKSkuc2V0QmFja2dyb3VuZChFUlJPUl9DT0xPUilcbiAgfVxuICByZXR1cm4ge1xuICAgIGNvbHVtbnM6IHNoZWV0LmdldFJhbmdlKDEsIDEsIDEsIHNoZWV0LmdldExhc3RDb2x1bW4oKSkuZ2V0VmFsdWVzKClbMF0sIFxuICAgIGNlbGxzOiBzaGVldC5nZXRSYW5nZShyb3csIDEsIDEsIHNoZWV0LmdldExhc3RDb2x1bW4oKSkuZ2V0VmFsdWVzKClbMF1cbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCB7b25JbnN0YWxsLCBvbk9wZW4sIGdldERhdGEsIGdlb2NvZGVkfSJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///148\n")}});